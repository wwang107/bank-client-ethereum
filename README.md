Please refer to the report "What Went Wrong with the Ethereum DOA Hack" to find out the theory and implementation